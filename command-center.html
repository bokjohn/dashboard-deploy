<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>‚ö° Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Dark Theme */
            --bg-primary: #0f1419;
            --bg-secondary: #1a1f2e;
            --bg-tertiary: #252d3d;
            --bg-card: #1e2532;
            --text-primary: #e8eaed;
            --text-secondary: #9aa0a6;
            --text-tertiary: #6b7280;
            
            /* Status Colors */
            --critical: #ef4444;
            --critical-bg: rgba(239, 68, 68, 0.1);
            --warning: #f59e0b;
            --warning-bg: rgba(245, 158, 11, 0.1);
            --success: #10b981;
            --success-bg: rgba(16, 185, 129, 0.1);
            --info: #3b82f6;
            --info-bg: rgba(59, 130, 246, 0.1);
            
            /* Accent */
            --accent: #667eea;
            --accent-hover: #5a67d8;
            
            /* UI */
            --border: #2d3748;
            --shadow: rgba(0, 0, 0, 0.3);
            --transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            
            /* Radii */
            --radius-sm: 6px;
            --radius-md: 12px;
            --radius-lg: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-lg);
        }

        /* === HEADER === */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: var(--space-md) var(--space-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .header-actions {
            display: flex;
            gap: var(--space-sm);
        }

        .btn-icon {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-size: 16px;
        }

        .btn-icon:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* === SECTION CARDS === */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .section h2 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* === BLOCKER ALERT === */
        .section-blockers {
            background: linear-gradient(135deg, var(--critical) 0%, #dc2626 100%);
            border: none;
            box-shadow: 0 10px 30px var(--critical-bg);
        }

        .section-blockers h2 {
            color: white;
        }

        .blocker-item {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .blocker-item:last-child {
            margin-bottom: 0;
        }

        .blocker-title {
            color: white;
            font-weight: 600;
            font-size: 16px;
            margin-bottom: var(--space-xs);
        }

        .blocker-meta {
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            margin-bottom: var(--space-sm);
        }

        .blocker-actions {
            display: flex;
            gap: var(--space-sm);
        }

        /* === DO NOW SECTION === */
        .section-priority {
            background: linear-gradient(135deg, var(--accent) 0%, #764ba2 100%);
            border: none;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .section-priority h2 {
            color: white;
        }

        .priority-task {
            background: white;
            color: #333;
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: var(--space-md);
            transition: var(--transition);
            cursor: pointer;
        }

        .priority-task:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .priority-task:last-child {
            margin-bottom: 0;
        }

        .priority-task-content {
            flex: 1;
        }

        .priority-task-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--space-xs);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .priority-task-meta {
            font-size: 13px;
            color: #666;
            display: flex;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .priority-task-actions {
            display: flex;
            gap: var(--space-sm);
            flex-shrink: 0;
        }

        /* === BUTTONS === */
        .btn {
            background: var(--success);
            color: white;
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }

        .btn:hover {
            background: #059669;
            transform: scale(1.05);
        }

        .btn-secondary {
            background: transparent;
            color: #666;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #f5f5f5;
            transform: scale(1.05);
        }

        .btn-sm {
            padding: 4px 10px;
            font-size: 12px;
        }

        /* === TWO COLUMN LAYOUT === */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        /* === TASK LIST === */
        .task-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: flex-start;
            gap: var(--space-md);
            transition: var(--transition);
            cursor: pointer;
        }

        .task-item:hover {
            border-color: var(--accent);
            transform: translateX(2px);
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--text-tertiary);
            border-radius: 4px;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 2px;
            transition: var(--transition);
        }

        .task-checkbox:hover {
            border-color: var(--success);
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            color: var(--text-primary);
            font-size: 14px;
            margin-bottom: var(--space-xs);
        }

        .task-meta {
            font-size: 12px;
            color: var(--text-tertiary);
            display: flex;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        /* === PROJECTS === */
        .project-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            transition: var(--transition);
            cursor: pointer;
        }

        .project-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-sm);
        }

        .project-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .project-health {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 600;
        }

        .health-on-track {
            background: var(--success-bg);
            color: var(--success);
        }

        .health-at-risk {
            background: var(--warning-bg);
            color: var(--warning);
        }

        .health-delayed {
            background: var(--critical-bg);
            color: var(--critical);
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
            margin: var(--space-sm) 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success) 0%, #059669 100%);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-fill.warning {
            background: linear-gradient(90deg, var(--warning) 0%, #d97706 100%);
        }

        .progress-fill.danger {
            background: linear-gradient(90deg, var(--critical) 0%, #dc2626 100%);
        }

        .project-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-tertiary);
        }

        /* === RECENT WINS === */
        .win-item {
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--border);
        }

        .win-item:last-child {
            border-bottom: none;
        }

        .win-check {
            color: var(--success);
            font-size: 16px;
        }

        .win-text {
            flex: 1;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .win-time {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        /* === BADGES === */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-high {
            background: var(--critical-bg);
            color: var(--critical);
        }

        .badge-medium {
            background: var(--warning-bg);
            color: var(--warning);
        }

        .badge-low {
            background: var(--info-bg);
            color: var(--info);
        }

        .badge-effort {
            background: var(--bg-primary);
            color: var(--text-secondary);
        }

        /* === MOBILE RESPONSIVE === */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-md);
            }

            .header {
                padding: var(--space-md);
            }

            .header h1 {
                font-size: 18px;
            }

            .two-column {
                grid-template-columns: 1fr;
                gap: var(--space-md);
            }

            .section {
                padding: var(--space-md);
            }

            .priority-task {
                flex-direction: column;
                align-items: stretch;
            }

            .priority-task-actions {
                width: 100%;
            }

            .priority-task-actions .btn {
                flex: 1;
            }

            .project-stats {
                flex-direction: column;
                gap: var(--space-xs);
            }
        }

        /* === SWIPE GESTURES (Mobile) === */
        .swipeable {
            position: relative;
            overflow: hidden;
        }

        .swipe-actions {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            display: flex;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .swipe-action {
            width: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .swipe-complete {
            background: var(--success);
        }

        .swipe-delete {
            background: var(--critical);
        }

        /* === FOCUS MODE === */
        body.focus-mode .section:not(.section-priority) {
            display: none;
        }

        body.focus-mode .header-actions {
            display: flex;
        }

        /* === LOADING STATE === */
        .loading {
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-secondary);
        }

        .empty-state {
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-tertiary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--space-md);
        }

        /* === ANIMATIONS === */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section {
            animation: slideIn 0.4s ease;
        }

        /* === KEYBOARD SHORTCUTS HINT === */
        .shortcuts-hint {
            position: fixed;
            bottom: var(--space-md);
            right: var(--space-md);
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: var(--space-sm) var(--space-md);
            font-size: 12px;
            color: var(--text-tertiary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .shortcuts-hint.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <h1>‚ö° Command Center</h1>
        <div class="header-actions">
            <button id="focusMode" class="btn-icon" title="Focus Mode (F)">üéØ</button>
            <button id="refresh" class="btn-icon" title="Refresh (R)">üîÑ</button>
        </div>
    </header>

    <!-- Main Container -->
    <main class="container" id="mainContainer">
        <div class="loading" id="loading">
            <div style="font-size: 32px; margin-bottom: 16px;">‚ö°</div>
            <div>Loading your command center...</div>
        </div>
    </main>

    <!-- Keyboard Shortcuts Hint -->
    <div class="shortcuts-hint" id="shortcutsHint">
        Press ? for keyboard shortcuts
    </div>

    <script>
        // === DATA MANAGEMENT ===
        let data = null;
        let focusMode = false;

        // Load data from external JSON
        async function loadData() {
            try {
                const response = await fetch('command-center-enhanced-structure.json');
                data = await response.json();
                renderCommandCenter();
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('loading').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ö†Ô∏è</div>
                        <h3>Could not load data</h3>
                        <p>Make sure command-center-enhanced-structure.json is in the same folder</p>
                    </div>
                `;
            }
        }

        // === RENDERING ===
        function renderCommandCenter() {
            const container = document.getElementById('mainContainer');
            
            // Separate tasks by status
            const blockers = data.tasks.filter(t => t.status === 'blocked');
            const activeTasks = data.tasks.filter(t => t.status !== 'blocked' && t.status !== 'completed');
            
            // Auto-prioritize top 3
            const topTasks = prioritizeTasks(activeTasks).slice(0, 3);
            const upNextTasks = prioritizeTasks(activeTasks).slice(3, 8);
            
            // Recent wins (last 48 hours)
            const recentWins = data.completions.filter(c => {
                const completedDate = new Date(c.completedDate);
                const now = new Date();
                const hoursSince = (now - completedDate) / (1000 * 60 * 60);
                return hoursSince <= 48;
            }).sort((a, b) => new Date(b.completedDate) - new Date(a.completedDate));

            container.innerHTML = `
                ${blockers.length > 0 ? renderBlockers(blockers) : ''}
                ${renderDoNow(topTasks)}
                <div class="two-column">
                    ${renderUpNext(upNextTasks)}
                    ${renderProjects(data.projects)}
                </div>
                ${recentWins.length > 0 ? renderRecentWins(recentWins) : ''}
            `;

            attachEventListeners();
        }

        // Prioritization algorithm
        function prioritizeTasks(tasks) {
            return tasks.sort((a, b) => {
                const scoreA = calculatePriorityScore(a);
                const scoreB = calculatePriorityScore(b);
                return scoreB - scoreA;
            });
        }

        function calculatePriorityScore(task) {
            let score = 0;
            
            // Priority weight
            if (task.priority === 'high') score += 100;
            else if (task.priority === 'medium') score += 50;
            else score += 10;
            
            // Due date urgency
            const now = new Date();
            const due = new Date(task.dueDate);
            const daysUntilDue = (due - now) / (1000 * 60 * 60 * 24);
            
            if (daysUntilDue < 1) score += 200;
            else if (daysUntilDue < 3) score += 100;
            else if (daysUntilDue < 7) score += 50;
            
            // Effort (quick wins)
            if (task.estimatedMinutes && task.estimatedMinutes <= 30) score += 25;
            
            // Business impact
            if (task.businessImpact === 'critical') score += 75;
            else if (task.businessImpact === 'high') score += 50;
            
            return score;
        }

        // === RENDER SECTIONS ===
        function renderBlockers(blockers) {
            return `
                <section class="section section-blockers">
                    <h2>üö® BLOCKERS (${blockers.length})</h2>
                    ${blockers.map(blocker => `
                        <div class="blocker-item">
                            <div class="blocker-title">‚ö†Ô∏è ${blocker.task}</div>
                            <div class="blocker-meta">
                                üì¶ ${blocker.project} ‚Ä¢ ‚è± ${blocker.estimatedMinutes || '?'}m
                                ${blocker.dependencies ? ` ‚Ä¢ Blocks ${blocker.dependencies.length} tasks` : ''}
                            </div>
                            <div class="blocker-actions">
                                <button class="btn btn-sm" onclick="resolveBlocker('${blocker.id}')">Resolve</button>
                                <button class="btn btn-secondary btn-sm" onclick="delegateTask('${blocker.id}')">Delegate</button>
                            </div>
                        </div>
                    `).join('')}
                </section>
            `;
        }

        function renderDoNow(tasks) {
            if (tasks.length === 0) {
                return `
                    <section class="section section-priority">
                        <h2>üî• DO NOW</h2>
                        <div class="empty-state">
                            <div class="empty-state-icon">üéâ</div>
                            <div>All caught up! No urgent tasks.</div>
                        </div>
                    </section>
                `;
            }

            return `
                <section class="section section-priority">
                    <h2>üî• DO NOW (Top 3)</h2>
                    ${tasks.map((task, i) => `
                        <div class="priority-task">
                            <div class="priority-task-content">
                                <div class="priority-task-title">
                                    <span>${i + 1}. ${task.task}</span>
                                    ${task.priority === 'high' ? '<span class="badge badge-high">HIGH</span>' : ''}
                                </div>
                                <div class="priority-task-meta">
                                    <span>üì¶ ${task.project}</span>
                                    <span>‚ö° ${task.estimatedMinutes || '?'}m</span>
                                    <span>Due: ${formatDueDate(task.dueDate)}</span>
                                </div>
                            </div>
                            <div class="priority-task-actions">
                                <button class="btn" onclick="completeTask('${task.id}')">‚úì Done</button>
                                <button class="btn btn-secondary" onclick="snoozeTask('${task.id}')">‚è∞</button>
                            </div>
                        </div>
                    `).join('')}
                </section>
            `;
        }

        function renderUpNext(tasks) {
            return `
                <section class="section">
                    <h2>
                        üìã UP NEXT (${tasks.length})
                        <span style="font-size: 12px; font-weight: normal; color: var(--text-tertiary);">
                            ${tasks.reduce((sum, t) => sum + (t.estimatedMinutes || 0), 0)}m total
                        </span>
                    </h2>
                    ${tasks.map(task => `
                        <div class="task-item swipeable" data-task-id="${task.id}">
                            <div class="task-checkbox" onclick="completeTask('${task.id}')"></div>
                            <div class="task-content">
                                <div class="task-title">${task.task}</div>
                                <div class="task-meta">
                                    <span>üì¶ ${task.project}</span>
                                    ${task.estimatedMinutes ? `<span class="badge badge-effort">‚ö° ${task.estimatedMinutes}m</span>` : ''}
                                    ${task.priority === 'high' ? '<span class="badge badge-high">HIGH</span>' : ''}
                                    ${task.priority === 'medium' ? '<span class="badge badge-medium">MED</span>' : ''}
                                </div>
                            </div>
                            <div class="swipe-actions">
                                <div class="swipe-action swipe-complete" onclick="completeTask('${task.id}')">‚úì</div>
                                <div class="swipe-action swipe-delete" onclick="deleteTask('${task.id}')">üóë</div>
                            </div>
                        </div>
                    `).join('')}
                </section>
            `;
        }

        function renderProjects(projects) {
            const activeProjects = projects.filter(p => p.status === 'active');
            
            return `
                <section class="section">
                    <h2>
                        üìä PROJECTS (${activeProjects.length})
                        <button class="btn-icon btn-sm" style="width: auto; padding: 4px 8px; font-size: 11px;">View All ‚Üí</button>
                    </h2>
                    ${activeProjects.slice(0, 3).map(project => {
                        const healthClass = project.health === 'on-track' ? 'health-on-track' : 
                                          project.health === 'at-risk' ? 'health-at-risk' : 'health-delayed';
                        const progressClass = project.progress >= 75 ? '' : 
                                            project.progress >= 50 ? 'warning' : 'danger';
                        
                        return `
                            <div class="project-card">
                                <div class="project-header">
                                    <div class="project-title">‚óã ${project.name}</div>
                                    <div class="project-health ${healthClass}">
                                        ${project.health === 'on-track' ? 'üü¢' : project.health === 'at-risk' ? 'üü°' : 'üî¥'} 
                                        ${project.health.replace('-', ' ')}
                                    </div>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill ${progressClass}" style="width: ${project.progress}%"></div>
                                </div>
                                <div class="project-stats">
                                    <span>${project.progress}% complete</span>
                                    <span>Due: ${formatDueDate(project.dueDate)}</span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </section>
            `;
        }

        function renderRecentWins(wins) {
            return `
                <section class="section">
                    <h2>
                        üéâ RECENT WINS (Last 48h)
                        <button class="btn-icon btn-sm" onclick="toggleSection(this)" style="width: auto; padding: 4px 8px; font-size: 11px;">Hide</button>
                    </h2>
                    <div class="wins-list">
                        ${wins.map(win => `
                            <div class="win-item">
                                <div class="win-check">‚úì</div>
                                <div class="win-text">${win.task}</div>
                                <div class="win-time">${formatTimeAgo(win.completedDate)}</div>
                            </div>
                        `).join('')}
                    </div>
                </section>
            `;
        }

        // === UTILITY FUNCTIONS ===
        function formatDueDate(dateStr) {
            const due = new Date(dateStr);
            const now = new Date();
            const days = Math.ceil((due - now) / (1000 * 60 * 60 * 24));
            
            if (days < 0) return `${Math.abs(days)}d overdue`;
            if (days === 0) return 'Today';
            if (days === 1) return 'Tomorrow';
            if (days < 7) return `in ${days} days`;
            return `in ${Math.ceil(days / 7)} weeks`;
        }

        function formatTimeAgo(dateStr) {
            const then = new Date(dateStr);
            const now = new Date();
            const hours = Math.floor((now - then) / (1000 * 60 * 60));
            
            if (hours < 1) return 'Just now';
            if (hours === 1) return '1 hour ago';
            if (hours < 24) return `${hours} hours ago`;
            if (hours < 48) return 'Yesterday';
            return `${Math.floor(hours / 24)} days ago`;
        }

        // === ACTIONS ===
        function completeTask(taskId) {
            alert(`‚úÖ Task completed: ${taskId}\n\nThis will integrate with your task system.`);
            console.log('Complete task:', taskId);
            // TODO: Integrate with actual task management
        }

        function resolveBlocker(taskId) {
            alert(`üîì Resolving blocker: ${taskId}`);
            console.log('Resolve blocker:', taskId);
        }

        function delegateTask(taskId) {
            alert(`üë• Delegating task: ${taskId}`);
            console.log('Delegate task:', taskId);
        }

        function snoozeTask(taskId) {
            alert(`‚è∞ Snoozed task: ${taskId}`);
            console.log('Snooze task:', taskId);
        }

        function deleteTask(taskId) {
            if (confirm('Delete this task?')) {
                alert(`üóë Deleted task: ${taskId}`);
                console.log('Delete task:', taskId);
            }
        }

        function toggleSection(button) {
            const section = button.closest('.section');
            const content = section.querySelector('.wins-list');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                button.textContent = 'Hide';
            } else {
                content.style.display = 'none';
                button.textContent = 'Show';
            }
        }

        // === EVENT LISTENERS ===
        function attachEventListeners() {
            // Focus mode
            document.getElementById('focusMode').addEventListener('click', () => {
                focusMode = !focusMode;
                document.body.classList.toggle('focus-mode');
            });

            // Refresh
            document.getElementById('refresh').addEventListener('click', () => {
                loadData();
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'f' && !e.ctrlKey && !e.metaKey) {
                    document.getElementById('focusMode').click();
                }
                if (e.key === 'r' && !e.ctrlKey && !e.metaKey) {
                    e.preventDefault();
                    loadData();
                }
                if (e.key === '?') {
                    showShortcuts();
                }
            });

            // Mobile swipe gestures
            if ('ontouchstart' in window) {
                setupSwipeGestures();
            }

            // Show keyboard hint briefly
            const hint = document.getElementById('shortcutsHint');
            setTimeout(() => hint.classList.add('show'), 1000);
            setTimeout(() => hint.classList.remove('show'), 4000);
        }

        function setupSwipeGestures() {
            let touchStartX = 0;
            let touchElement = null;

            document.addEventListener('touchstart', (e) => {
                if (e.target.closest('.swipeable')) {
                    touchStartX = e.touches[0].clientX;
                    touchElement = e.target.closest('.swipeable');
                }
            });

            document.addEventListener('touchmove', (e) => {
                if (touchElement) {
                    const touchX = e.touches[0].clientX;
                    const diff = touchStartX - touchX;
                    
                    if (diff > 0 && diff < 160) {
                        const actions = touchElement.querySelector('.swipe-actions');
                        actions.style.transform = `translateX(${100 - (diff / 160 * 100)}%)`;
                    }
                }
            });

            document.addEventListener('touchend', () => {
                if (touchElement) {
                    const actions = touchElement.querySelector('.swipe-actions');
                    actions.style.transform = 'translateX(100%)';
                    touchElement = null;
                }
            });
        }

        function showShortcuts() {
            alert(`
‚å®Ô∏è Keyboard Shortcuts:

F - Toggle Focus Mode
R - Refresh data
? - Show this help

Coming soon:
1-3 - Jump to DO NOW tasks
N - New task
/ - Search
            `.trim());
        }

        // === INITIALIZATION ===
        loadData();
    </script>
</body>
</html>
